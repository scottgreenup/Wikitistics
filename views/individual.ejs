<DOCTYPE html>
<head>
  <%- include header.ejs %>
</head>

<body>
  <%- include nav.ejs %>

  <div class="container">
    <h1 id="title">Individual Statistics</h1>

    <div id="container-dropdown" class="container">
      <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
          Article Select <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1" id="articleList">
        </ul>
      </div>
    </div>

    <table class="table table-striped table-bordered" id="statistics">
      <tr>
        <td>Most revisions</td>
        <td id="stats-most-revisions"></td>
      </tr>
      <tr>
        <td>Least revisions</td>
        <td id="stats-least-revisions"></td>
      </tr>
      <tr>
        <td>Most registered users</td>
        <td id="stats-most-users"></td>
      </tr>
      <tr>
        <td>Least registered users</td>
        <td id="stats-least-users"></td>
      </tr>
      <tr>
        <td>Oldest article</td>
        <td id="stats-oldest"></td>
      </tr>
      <tr>
        <td>Youngest article</td>
        <td id="stats-youngest"></td>
      </tr>
    </table>

    <div class="container">

      <ul class="nav nav-tabs">
        <li class="active"><a href="#1" data-toggle="tab">User Revisions by Year</a>
        <li><a href="#2" data-toggle="tab">User Revisions by User Type</a>
      </ul>

      <div class="tab-content" id="chart-tabs">
        <div class="tab-pane active" id="1">
          <div id="chartContainer" style="height: 400px; width: 100%;"></div>
        </div>
        <div class="tab-pane" id="2">
          <div id="pieChart" style="height: 400px; width: 100%;"></div>
        </div>
      </div>
    </div>
  </div>

  <%- include footer.ejs %>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/canvasjs/1.7.0/canvasjs.min.js"> </script>

  <script>
    window.onload = function() {

      $.urlParam = function (name) {
        var results = new RegExp('[\?&]' + name + '=([^&#]*)')
          .exec(window.location.href);

        return results[1] || null;
      }

      var title = $.urlParam('article');

      if (title) {
        title = decodeURIComponent(title);
        $('#title').html(title);
      }

      $.get({
        url: '/individual/articleList',
        success: function(data) {
          var domList = "";
          data.forEach(function(str) {
            domList += '<li><a href="/individual?article=' + str + '">' + str + '</a></li>';
          });
          $('#articleList').append(domList);
        }
      });
    }
  </script>
</body>

